# 论文阅读报告: Physiological control for left ventricular assist devices based on deep reinforcement learning

## **1. 元数据**
- **作者:** Diego Fernández-Zapico, Thijs Peirelinck, Geert Deconinck, Dirk W. Donker, Libera Fresiello
- **发表日期:** 2024-09-17
- **阅读日期:** 2025-09-09
- **标签:** VAD, Reinforcement Learning, Control Systems

## **2. 核心摘要**
**一句话总结:** 本文提出了一种基于深度强化学习（DRL）的左心室辅助装置（LVAD）控制器，旨在通过模拟生理控制，防止心室抽吸并允许主动脉瓣开放。

### 研究动机
目前临床上使用的LVAD大多以恒速模式运行，无法根据患者生理需求进行实时调整，可能导致心室抽吸、主动脉瓣关闭等不良事件。因此，研究者希望开发一种能够自动、实时调节LVAD转速的生理控制器，以改善血液动力学状况，减少并发症。

## **3. 方法论**
### 模型

![PPO 模型结构](./D83C629C8E4F7E4DEC39DCFCBEC387BA.png)

本文提出的控制器基于近端策略优化（PPO）强化学习算法，在一个高保真度的确定性心肺循环模拟器中进行训练。奖励函数的设计旨在`鼓励主动脉瓣开放和保持适度的左心室前负荷`。
#### 输入
| 输入信号 (State) | 符号 | 描述 | 测量方式 |
| :--- | :--- | :--- | :--- |
| 当前EDP偏差 | `SEDP_t` | 当前心动周期的舒张末期压力(EDP)与参考EDP之差 | 模拟器内部计算 |
| 上一周期EDP偏差 | `SEDP_{t-1}` | 上一心动周期的舒张末期压力(EDP)与参考EDP之差 | 模拟器内部计算 |
| 当前收缩压差 | `Svalve_t` | 当前心动周期的左心室最大压力与主动脉最大压力之差 | 模拟器内部计算 |
| 上一周期收缩压差 | `Svalve_{t-1}`| 上一心动周期的左心室最大压力与主动脉最大压力之差 | 模拟器内部计算 |
#### 输出
| 输出动作 (Action) | 值 | 描述 | 测量方式 |
| :--- | :--- | :--- | :--- |
| 泵速调整因子 | `+0.01` | 增加LVAD转速 | 控制器计算出的指令信号，非物理测量 |
| 泵速调整因子 | `-0.01` | 减小LVAD转速 | 控制器计算出的指令信号，非物理测量 |

#### 奖励函数
奖励函数由两部分组成 (`r = rA + rB`)，旨在鼓励主动脉瓣开放和保持适度的左心室前负荷。

-   **`rA` (维持前负荷稳定):**
    这部分奖励旨在根据舒张末期压力 (EDP) 与目标值的偏差 (`SEDP`) 调整泵速。
    -   当 `SEDP` 和泵速调整方向 `a` 的乘积为正（即高前负荷时增速，低前负荷时降速），`rA = 1`。
    -   当乘积为负时，`rA = -2`，以示惩罚。

-   **`rB` (促进主动脉瓣开放):**
    这部分奖励旨在通过调整泵速以促进主动脉瓣开放。该部分基于收缩期左心室与主动脉之间的最大压力差 `Svalve`。
    -   当 `Svalve` 和泵速调整方向 `a` 的乘积为正，`rB = 1`。
    -   当乘积为负时，`rB = 0`。

最终的奖励函数 `r = rA + rB` 更侧重于维持前负荷稳定（`rA` 的惩罚项更大）。

## **4. 实验与结论**
### 实验
研究人员在心肺循环模拟器中，改变总血容量（TBV）、心率（HR）、全身血管阻力（SVR）、肺血管阻力（PVR）、左心室舒张末期弹性（Els）和右心室舒张末期弹性（Ers）六个心血管参数。他们在此环境下训练了DRL控制器，并将其性能与恒速LVAD策略进行了比较。

### 结论
与恒速LVAD相比，本文提出的DRL控制器表现出以下优势：
- **更稳定的舒张末期容积（EDV）:** DRL控制器的EDV标准差为5mL，而恒速LVAD为9mL。
- **更高的主动脉流量:** DRL控制器下的平均主动脉流量为1.1 L/min，高于恒速LVAD的0.9 L/min。

## **5. 分析**
### 启发点
- **使用高保真模拟器生成数据:** 使用高保真度的模拟器进行控制器训练，可以安全、高效地产生大量多样化的生理数据，为强化学习的应用提供了良好的基础。

- **输出指标:**使用转速调整因子而非转速

### 不足/改进空间/未来研究计划 (详细)
- **不足:**
    - **模型与现实差距 (Simulation-to-Reality Gap):** 研究完全基于计算机仿真，虽然模拟器保真度高，但与真实人体的复杂动态（如自主神经反射、体液调节）和硬件限制（如传感器噪声、执行器延迟）仍存在显著差距。
    - **离散动作空间限制:** 控制器输出为固定的泵速调整因子（+0.01/-0.01），这种离散化处理导致其无法对快速变化的生理需求（尤其是心率突变）做出平滑、迅速的响应，适应性受限。
    - **次优的奖励函数设计:** 奖励函数的设计存在缺陷。首先，将动作本身（`a`）作为奖励的一部分（`rA`），可能限制智能体的探索，易陷入局部最优。其次，未能将恢复血流脉动性作为直接优化目标，导致其控制结果（接近连续流）可能引发长期生理风险。
    - **评估指标说服力不足:** 以“更高的平均主动脉流量”作为主要结论，未能充分体现DRL控制器在自适应性和安全性方面的核心优势。

- **改进空间:**
    - **引入连续动作空间:** 可将动作空间从离散改为连续值（例如，直接输出泵速或泵速变化量），并采用如DDPG、SAC等能够处理连续动作的强化学习算法，以实现更平滑、更快速的控制响应。
    - **重构奖励函数:** 1) 将动作项从奖励函数中剥离，避免对探索的干扰。2) 引入脉动性相关指标（如脉压差、脉动指数PI）作为新的奖励项，或对低脉动性进行惩罚，以引导控制器学习更符合生理的搏动模式。
    - **升级评估体系:** 放弃使用单一的平均流量指标。应设计更复杂的动态测试场景（如模拟从休息到运动的快速过渡、姿态变化等），通过评估控制器在这些场景下的响应时间、超调量、以及维持关键生理指标（如LVEDP、MAP）的稳定性来综合证明其自适应优势。

- **未来研究计划:**
    - **物理平台验证:** 第一步，将训练好的模型部署到体外循环回路（in-vitro）中进行硬件在环测试，以验证其在物理系统中的可行性和鲁棒性。
    - **动物实验研究:** 第二步，在获批后，于大动物模型（如猪、羊）上进行在体（in-vivo）实验，评估控制器在真实生理环境下的安全性、有效性及长期影响。
    - **扩展状态与模型:** 探索引入更丰富的状态信息，例如完整的压力/流量波形而非单个特征值，并结合LSTM、Transformer等能处理时序数据的网络结构，以使控制器能捕捉更深层次的血流动力学特征。
- **不足:**
    - **模型与现实差距 (Simulation-to-Reality Gap):** 研究完全基于计算机仿真，虽然模拟器保真度高，但与真实人体的复杂动态（如自主神经反射、体液调节）和硬件限制（如传感器噪声、执行器延迟）仍存在显著差距。
    - **离散动作空间限制:** 控制器输出为固定的泵速调整因子（+0.01/-0.01），这种离散化处理导致其无法对快速变化的生理需求（尤其是心率突变）做出平滑、迅速的响应，适应性受限。
    - **次优的奖励函数设计:** 奖励函数的设计存在缺陷。首先，将动作本身（`a`）作为奖励的一部分（`rA`），可能限制智能体的探索，易陷入局部最优。其次，未能将恢复血流脉动性作为直接优化目标，导致其控制结果（接近连续流）可能引发长期生理风险。
    - **评估指标说服力不足:** 以“更高的平均主动脉流量”作为主要结论，未能充分体现DRL控制器在自适应性和安全性方面的核心优势。

- **改进空间:**
    - **引入连续动作空间:** 可将动作空间从离散改为连续值（例如，直接输出泵速或泵速变化量），并采用如DDPG、SAC等能够处理连续动作的强化学习算法，以实现更平滑、更快速的控制响应。
    - **重构奖励函数:** 1) 将动作项从奖励函数中剥离，避免对探索的干扰。2) 引入脉动性相关指标（如脉压差、脉动指数PI）作为新的奖励项，或对低脉动性进行惩罚，以引导控制器学习更符合生理的搏动模式。
    - **升级评估体系:** 放弃使用单一的平均流量指标。应设计更复杂的动态测试场景（如模拟从休息到运动的快速过渡、姿态变化等），通过评估控制器在这些场景下的响应时间、超调量、以及维持关键生理指标（如LVEDP、MAP）的稳定性来综合证明其自适应优势。

- **未来研究计划:**
    - **物理平台验证:** 第一步，将训练好的模型部署到体外循环回路（in-vitro）中进行硬件在环测试，以验证其在物理系统中的可行性和鲁棒性。
    - **动物实验研究:** 第二步，在获批后，于大动物模型（如猪、羊）上进行在体（in-vivo）实验，评估控制器在真实生理环境下的安全性、有效性及长期影响。
    - **扩展状态与模型:** 探索引入更丰富的状态信息，例如完整的压力/流量波形而非单个特征值，并结合LSTM、Transformer等能处理时序数据的网络结构，以使控制器能捕捉更深层次的血流动力学特征。

### 引
- soft-critic-actor