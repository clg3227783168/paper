# 论文阅读报告: A Physiological Control System for Pulsatile Ventricular Assist Device Using an Energy-Efficient Deep Reinforcement Learning Method

## **1. 元数据**
- **作者:** Te Li, Member, IEEE, Wenbo Cui , Xingjian Liu , Member, IEEE, Xu Li , Nan Xie , and Yongqing Wang
- **发表日期:** 2023-05-24
- **阅读日期:** 2025-09-19
- **标签:** VAD, DRL, Energy-Efficient

## **2. 核心摘要**
**一句话总结:** 本文提出了一种基于深度强化学习（DRL）的能量效率高的搏动式心室辅助装置（PVAD）生理控制系统，该系统通过使用AdderNet替代全连接网络，在不降低性能的情况下，将传统DRL算法的能耗降低至44.8%。

### 研究动机
传统的PID控制器在适应患者生理变化方面能力不足，而现有的基于神经网络的控制器虽然适应性强，但计算能耗高，不适合植入式设备长期使用。因此，需要一种既能高效适应生理变化，又能降低计算能耗的PVAD控制方法。

## **3. 方法论**
### 模型 (AddTD3)
#### 输入
| 参数 | 测量方式 |
| :--- | :--- |
| E[k] | 目标主动脉压与实际主动脉压的绝对误差 |
| PA[k] | 一个心跳周期内的平均主动脉压 |
| Fsign | 根据误差E[k]是否小于1来判断的标志位 |

#### 输出
| 参数 | 测量方式 |
| :--- | :--- |
| Pe | PVAD的射血压力 |

#### 模型结构
该模型基于TD3（Twin Delayed Deep Deterministic Policy Gradient）算法进行改进。其核心是将策略网络（PolicyNet/Actor）中的全连接层（FC）替换为能效更高的加法网络（AdderNet），从而显著降低计算能耗。
- **策略网络 (PolicyNet):** 包含两个隐藏层，每层有128个单元。为了解决直接替换为AdderNet后模型不收敛的问题，作者在AdderNet后引入了层归一化（Layer Normalization），并且输出层通过一个含有8个隐藏单元的全连接层进行重新加权。
- **评论家网络 (CriticNet):** 包含一个隐藏层，有128个单元，激活函数为ReLU。

#### 奖励函数
奖励函数 `Rt` 被设计为三个部分的和: `Rt = Rgoal + Rclose + Rsta`，旨在将平均动脉压稳定在目标值附近，同时抑制控制器振荡。
- `Rgoal`: 目标奖励。当系统处于健康状态（误差`E[k]`近似为0）时为1；当误差过大时为-5，并终止当前回合；其他情况为0。
- `Rclose`: 逼近奖励。一个分段线性函数，鼓励将压力维持在目标值附近。
- `Rsta`: 稳定奖励。一个对控制器输出变化（`action`）的惩罚项，以抑制振荡。

综合起来，具体的函数形式如公式(10)所示：
- 当 `0 < E[k] < 1` (误差很小): `Rt = 1 - a*E[k] - action²`
- 当 `1 < E[k] <= 20` (误差在接受范围): `Rt = -a*E[k] - action²`
- 当 `E[k] > 20` (误差过大): `Rt = -5 - a*E[k]`

其中，`E[k]` 是目标压力与实际压力的绝对误差，`action²` 是对控制器输出变化的惩罚项，`a` 是奖励的归一化因子。

## **4. 实验与结论**
### 实验
实验分为仿真实验和体外循环（MCS）实验两部分。
1.  **仿真实验:**
    *   **单因素实验:** 分别改变体循环阻力（Rs）、心率（HR）、最大心肌弹性（Emax）和目标压力（Ptarget）中的一个参数。
    *   **多因素实验:** 同时随机改变上述四个参数。
2.  **体外循环实验 (MCS):**
    *   **心力衰竭场景:** 降低心脏模拟器的泵血能力并增加血管阻力。
    *   **休息到运动场景:** 增加心率并降低血管阻力。

### 结论
1.  **高适应性:** 所提出的基于DRL的控制器（AddTD3）比传统的PID控制器有更高的适应能力，累积绝对误差（SAE）显著降低。
2.  **高能效:** AddTD3算法将传统DRL算法（TD3）的计算能耗降低了55.2%（从77721.6 pJ降低到34835.2 pJ），而控制性能没有明显下降。
3.  **可迁移性:** 在仿真环境中训练好的模型可以直接迁移到MCS物理系统中，无需微调，并表现出良好的控制效果。在MCS实验中，AddTD3的SAE仅为PID控制器的42%左右。

## **5. 分析**
### 启发点
- **AdderNet的应用:** 使用加法网络（AdderNet）替代乘法运算为主的传统神经网络层，是降低端侧AI计算能耗的一个有效途径，尤其适用于计算资源受限的植入式医疗设备。
- **模仿学习与ADR:** 在DRL训练初期引入模仿学习（Imitation Learning）来预训练智能体，并结合自动域随机化（ADR）技术来增强模型的泛化能力，这种训练策略可以加速收敛并提高模型的鲁棒性。

### 不足与局限
- **模型验证:** 实验仅在体外循环系统（MCS）中进行，尚未在动物或临床实验中验证其有效性和安全性。MCS无法完全模拟真实人体循环系统的复杂动态特性。
- **传感器限制:** 控制系统依赖于主动脉压力信号，而长期、稳定、无创地获取该信号在临床上仍是一个挑战。
- **单一输出:** 控制器仅调节射血压力（Pe），而实际应用中可能需要同时协调多个参数（如射血延迟、持续时间等）以达到更优的生理辅助效果。

### 存疑之处
- 论文提到，简单的将TD3中的全连接层替换为AdderNet会导致算法难以收敛，但对于为何必须引入层归一化（LN）和输出层加权才能解决这个问题的根本原因，论述不够深入。
- 奖励函数的设计中包含了一个抑制控制器振荡的惩罚项 `action²`，但没有详细说明`action`的具体定义和量化方式，以及这个惩罚项的权重是如何选择的。