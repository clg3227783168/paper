---
marp: true
size: 16:9
headingDivider: [2,3,4]
paginate: true
footer: '陈良柱'
---

# VAD 控制策略文献实验设计总结分析

## 一、 实验平台分析

### 1. 计算机仿真 (In-Silico)
几乎所有都以计算机仿真作为基础或唯一的验证平台。
- 主要使用 **MATLAB/Simulink** 搭建包含心血管系统和 VAD 的耦合集总参数模型。
- 成本低、效率高、可重复性强，但集总参数模型是对复杂生理系统的简化。

围绕耦合集总参数模型的选择上，比较经典的是5参数模型，6参数模型和7参数模型，也就是拿5,6,7个电阻,电感,电容这种电路元件模拟心血管系统和 VAD 的耦合系统。有的论文会对经典模型进行一些小改动，但是没有在论文中说明改动的原理和动机，只是一笔带过这是实验室提出的新模型，所以想要从集总参数模型的改动入手，而且做到很强的可解释性是很难的。总之，不能很突兀地提出一个非公认的模型，要能够自圆其说。既要考虑到控制方案的普适性；又要从实际出发提出符合心脏生理状态和血流动力学的假设，方便控制方案的设计。

### 2. 物理实验验证 (In-Vitro / In-Vivo)
部分研究（特别是 `critic-actor-lstm`、`economic_RL` 和 `mix`）在仿真之外，引入了更高层级的物理验证，以增强结论的可靠性。
- **体外循环 (In-Vitro):** 使用**模拟循环回路 (Mock Circulation Loop, MCL/MCS)**，通过物理组件模拟心脏和血管系统。
- **动物实验 (In-Vivo):** `mix` 的研究中包含了三例动物（猪）实验。
- **临床数据:** `FC-CNN` 的研究使用了包含25名患者的临床数据集来训练和验证其无创前负荷估计器。
---
获取足够的临床数据进行生理状态和信号的估计是一个很好的思路，使用了大量已有数据作为经验数据，减少传感器的使用，能够以无传感器作为创新点，传感器更少往往意味着更少的并发症，但是难以兼顾病人的个体差异性。

一定要有模拟循环回路的实验，目前做动物实验的还是非常少的。

## 二、 核心实验设计要素对比

### `FC-coupled_model` (传统/模糊控制)

- **测试场景**: 
  1. **个体差异：** 模拟三种不同体型（瘦、正常、肥胖）的患者 
  2. **极端场景：**阶跃增/减左心室前负荷 (吸引/反流) 
  3. **静息运动转换：**平滑改变生理参数以模拟“休息-运动”和“休息-睡眠”的过渡
- **测试平台**: 仿真
- **对比基线 (Baseline)**: 恒速控制
- **关键评估指标**: **心脏指数(CI)**、防吸引/反流

### 心脏指数 (Cardiac Index, CI)

心脏指数 (CI) 是一个用于评估心脏泵血功能的核心指标。与单纯衡量总血流量的心输出量 (Cardiac Output, CO) 不同，心脏指数通过将心输出量根据**体表面积 (Body Surface Area, BSA)** 进行标准化，从而消除了个体体型差异带来的影响。

**计算公式:**
`CI = CO / BSA` (单位: L/min/m²)
#### CI测量

`FC-coupled_model` 论文中**并未直接“测量”心脏指数**，而是通过一种**无传感器模型估计**的方法来计算和控制它。

具体分为两个部分：

1.  **目标心脏指数 (`CI_des`) 的设定:**
    *   控制器根据患者的**心率 (HR)**、**身高**和**体重**，通过一系列公式预先计算出一个理想的、个性化的目标心脏指数。心率（HR）可以通过体表心电图无创获取。

2.  **反馈心脏指数 (`CI_fb`) 的计算:**
    *   系统将**平均泵流量 (`Q_rp`)** 作为心输出量（CO）的近似值。
    *   泵流量 `Q_rp` **不是由植入式流量传感器直接测量的**。而是通过获取泵的**电机电流（I）**和**转速（ω）**，估算平均泵流量。
    *   最后，用这个估算出的平均泵流量除以患者的体表面积。
---
**总结来说**，这也是一个避免额外传感器的思路，但是和心输出量一样，心脏指数也就是单位表面积的心输出量的理想值也是动态变化的。

### `FC` (传统/模糊控制)

- **测试场景**: 在第50、80、100秒时，逐步降低系统血管阻力(SVR)
- **测试平台**: 仿真
- **对比基线 (Baseline)**: PI控制器
- **关键评估指标**: 响应速度、防抽吸安全边界

### `FC-CNN` (经典+机器学习)

- **测试场景**: 
  1. 肺血管阻力(PVR)升高/降低 
  2. 全身血管阻力(SVR)升高/降低
- **测试平台**: 仿真 + 临床数据
- **对比基线 (Baseline)**: PID控制器
- **关键评估指标**: 前负荷估计精度
很经典的指标，根据Frank–Starling机制，心脏每搏输出量在所有其他因素保持不变的情况下，会随着心脏前负荷的增加而增加。


### `PPSMC-ffn` (经典+机器学习)

- **测试场景**: 
  1. **静息**: 总血容量减少500mL, 心室收缩力增加15% 
  2. **运动**: 总血容量增加500mL, 心室收缩力下降20%, 外周阻力增加15%
- **测试平台**: 仿真
- **对比基线 (Baseline)**: 恒速控制
- **关键评估指标**: 鲁棒性、安全流量范围

### `CNN` (机器学习)

- **测试场景**: 
  1. **多生理参数扰动** 
  2. **休息到运动**的转换 
  3. **被动体位变化**
- **具体参数变化/扰动**: 
  1. 肺血管阻力(PVR)升高/降低 
  2. 全身血管阻力(SVR)升高/降低
- **测试平台**: 仿真
- **对比基线 (Baseline)**: (与有传感器版本对比)
- **关键评估指标**:精度、吸引/反流检测准确率

### `KNN-SVM-ANN` (机器学习)

- **测试场景**: **3x3x3组合**: 
  - **心率(HR):** 正常, 心动过速, 心动过缓 
  - **前负荷(Preload):** 低, 正常, 高 
  - **后负荷(Afterload):** 低, 正常, 高
- **测试平台**: 仿真
- **对比基线 (Baseline)**: (不同AI模型间对比)
- **关键评估指标**: 吸引/反流检测准确率

### `soft-critic-actor` (强化学习 (RL))

- **测试场景**: 
  1. 系统血管阻力(Rs)变化 
  2. 心肌收缩力(Emax)变化 
  3. 心率(HR)变化 (模拟休息到运动)
- **测试平台**: 仿真
- **对比基线 (Baseline)**: PID控制器
- **关键评估指标**: 响应时间、精度

### `PPO` (强化学习 (RL))

- **测试场景**: 同时或单独改变总血容量(TBV), 心率(HR), 全身/肺血管阻力(SVR/PVR), 左/右心室舒张末期弹性(Els/Ers)
- **测试平台**: 仿真
- **对比基线 (Baseline)**: 恒速控制
- **关键评估指标**: 舒张末期容积(EDV)稳定性、主动脉流量

### `critic-actor-lstm` (强化学习 (RL))

- **测试场景**: 
  1. 中度心衰 vs. 重度心衰 
  2. 心率突变 (75 → 120 bpm) 
  3. 射血相位延迟 (0.1s)
- **测试平台**: **仿真 + 体外(In-Vitro)**
- **对比基线 (Baseline)**: 恒速、预设脉动控制
- **关键评估指标**: **脉动性(PP, PI)、波形相似度(DTW)**、自适应性(误差, 响应时间)

### `economic_RL` (强化学习 (RL))

- **测试场景**: 
- **具体参数变化/扰动**: 
  1. **仿真**: 参数单独或同时改变 
  2. **体外**: 模拟心衰(降泵能/增阻力)和运动(增心率/降阻力)
- **测试平台**: **仿真 + 体外(In-Vitro)**
- **对比基线 (Baseline)**: PID, 传统DRL(TD3)
- **关键评估指标**: 精度、**计算能耗**、自适应性(误差, 响应时间)

### `mix` (综合研究)

- **测试场景**: 
  1. **泵位置偏移** 
  2. **不同心衰等级** 
  3. **前后负荷变化** 
  4. **泵内反流**
- **测试平台**: **仿真 + 体外 + 动物**
- **对比基线 (Baseline)**: PI, 恒速控制
- **关键评估指标**: **反流估计精度**、自适应性(误差, 响应时间)

## 三、 总结与分析

### 对比基线

对比基线的选择十分重要，能够提升实验效果的说服力。普遍采用**恒速、PID控制器**作为性能对比的标准。
### 测试场景
血管阻力变化 (Rs / SVR)；心肌收缩力 (Emax) ；血容量变化；心率变化；各种负面事件；不同体型。
设计不同体型的测试场景和在评价指标上使用心脏指数，其实都是对个体差异的关注。
####  更具针对性的场景，如模拟泵的位置偏移 (`mix`)。
这是一个非常好的思路，没有看到其他的论文有类似的。
在软件模拟上，提出了一个非线性时间电阻模拟主动脉瓣，将泵的位置偏移转换为主动脉瓣的电阻参数改变。
在模拟循环回路上，手动调整导管泵的位置，使其直接压迫人工主动脉瓣的不同部分复现轻度、中度、重度的偏移。
在猪模型实验中，在心脏超声的引导下，精确地调整植入猪体内的导管泵的位置，使其尖端对猪自身的主动脉瓣产生不同程度的压迫，从而在活体动物模型上复现泵位置偏移的情况。

---

在提出这个思路的动机上，也说得比较清楚。
机械性反流是指由于 VAD设备位置的异常。及时调整泵位置。
动力性反流：动力性反流是指当 VAD 泵的转速过低时，由于泵内压力不足以推动足够的血流通过 VAD 系统，血液可能会逆流回左心室，从而产生泵内反流。动力性反流可以通过调整 VAD泵速来减少。
瓣膜性反流：瓣膜性反流是指 VAD 辅助下，由于左心室和主动脉之间的瓣膜异常或功能障碍，导致血液逆流。
没有研究涉及机械性反流

但是，注意到论文提出了如何估计机械性反流，MPC控制策略的验证和应用场景却是针对动力性反流的。因为VAD自主智能的移位还是非常难的。

事实上，位置偏移还可能导致其他结果，不仅仅是主动脉瓣。如果泵的入口距离心室壁太近，会导致抽吸，流场不佳：如果泵的出口位置不理想，可能会形成高速血流直接冲击血管壁。

### 评估指标的深化
包括基本的生理学参数精度，系统响应时延，波形相似度，脉动性，心脏指数，计算能耗。

计算能耗的减少其实是在软件层面上实现的，将全连接神经网络改成了点加神经网络，减少了数据传播时计算的规模，不过也减少了可供训练和学习的参数量，降低了模型的拟合能力。

总之，评估指标必须要有理论依据，最好足够细化。

### 局限性
-   除少数例外，研究普遍**缺乏长期的稳定性评估**。
-   **动物实验和临床数据仍然稀缺**。
-   **右心功能:** 多数模型将右心功能理想化，未考虑左右心室相互作用带来的影响。

#### 压力感受器反射的忽略
压力感受器分布在主动脉弓和颈动脉窦等大血管壁上。它们能实时感知血管被拉伸的程度，从而判断当前的血压高低。
若血压过低大脑会增强交感神经活动，同时减弱副交感神经活动，心率加快，心肌收缩力增强，全身血管收缩，血压回升至正常水平。
若血压过高，则反之，大脑会减弱交感神经活动、增强副交-感神经活动，使心率减慢、血管舒张，从而降低血压。

---
压力感受器反射是常被忽略的关键机制
    1.  **直接证据:** 在 `ml/CNN` 和 `classic_ctrl-ml/FC-CNN` 的“局限性”部分，作者明确指出其模型“未考虑压力感受器反射（如压力反射）对心血管系统的影响”。
    2.  **间接证据:** 大多数研究将心血管系统描述为“集总参数模型”，其核心是模拟流体动力学的物理特性（如阻力、顺应性），并未提及实现复杂的神经反馈回路。如果包含了这一重要机制，通常会作为亮点进行说明。
    3.  **例外情况的佐证:** 少数研究（如 `classic_ctrl/FC-coupled_model`）明确提出其模型包含了“压力感受器反射模型”。

如何利用好压力感受器反射？->把压力作为输入
FC-coupled_model这篇文章提到可以体表传感器检测主动脉压，但是这篇文章只停留在了计算机仿真阶段。
是否可以使用无线贴片式血压传感器和植入体内的VAD配合，来利用好压力感受器反射。